# 4. Продвинутые темы

В этом разделе собраны рекомендации и примеры по расширению стандартных систем GOAT, работе с глобальными сигналами и архитектурным best practices.

## Расширение систем

- **Наследование сцен**: Для добавления новой логики создавайте свои сцены на основе стандартных (`Player.tscn`, `InteractiveItem.tscn`, `Inventory.tscn` и т.д.).
- **Композиция**: Используйте дочерние узлы и отдельные скрипты для расширения функционала без изменения оригинальных файлов шаблона.
- **Собственные UI**: Можно создавать свои окна инвентаря, диалогов, настроек, подписываясь на сигналы глобальных синглтонов.

## Глобальные сигналы

- Все основные системы (инвентарь, взаимодействие, диалоги, настройки) используют сигналы для уведомления о событиях.
- Подписывайтесь на нужные сигналы в своих скриптах:

```gdscript
# Пример: реагировать на добавление предмета в инвентарь
func _ready():
    goat_inventory.connect("item_added", self._on_item_added)

func _on_item_added(item_name):
    print("Добавлен предмет:", item_name)
```

- Не забывайте отключать сигналы при удалении объектов, чтобы избежать утечек памяти.

## Best practices

- **Строгая типизация**: Всегда используйте типы для переменных и аргументов функций.
- **Документирование**: Описывайте сложные функции docstring-комментариями на английском языке.
- **Именование**: Следуйте конвенциям (PascalCase для сцен, snake_case для методов и переменных).
- **Минимизация связей**: Используйте сигналы и композицию вместо прямых ссылок между объектами.
- **Ресурс-менеджмент**: Очищайте ресурсы в `_exit_tree()` и используйте preload для важных ассетов.

## Примеры расширения

- **Добавить новый тип интерактивного объекта**:
    1. Унаследуйте сцену от `InteractiveItem.tscn`.
    2. Добавьте новые свойства и методы.
    3. Подключите к нужным сигналам.

- **Глобальные события через EventBus**:
    - Для событий, которые должны быть доступны во всём проекте, используйте автозагрузку EventBus и определяйте в нём сигналы.

```gdscript
# Пример EventBus.gd
extends Node
signal player_died

# В любом месте проекта
EventBus.emit_signal("player_died")
```

## Отладка и тестирование

- Используйте assert для проверки предположений в коде.
- Для вывода ошибок используйте print и push_error.
- Для сложных систем пишите юнит-тесты на GUT или встроенных средствах Godot.
